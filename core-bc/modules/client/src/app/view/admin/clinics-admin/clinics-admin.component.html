<app-menu-title-row>

    <div class="menu-title-item">
  <div class="breadcrumbs">
      <a routerLink="../..">Startsida</a>
      <app-chevron-right></app-chevron-right>
    <a routerLink="..">Administration</a>
    <app-chevron-right></app-chevron-right>
    Kliniker
  </div>
  </div>

</app-menu-title-row>

<app-row>
  <app-left-column>

      <h1 class="page-title">Kliniker</h1>

      <vgr-page-block>
    
          <vgr-list>

            <vgr-list-item *ngFor="let clinic of clinics" (expandedChanged)="setCurrentClinic($event, clinic)" #theListItem>
              <vgr-list-item-header>
                <vgr-list-column [width]="3">{{clinic.id}}</vgr-list-column>
                <vgr-list-column [width]="4">{{clinic.name}}</vgr-list-column>
              </vgr-list-item-header>
    
              <vgr-list-item-content>

                <form [formGroup]="clinicForm" (ngSubmit)="saveClinic()">

                    <vgr-card>
                        <vgr-card-column>

                          <vgr-title-value-layout>
                              <vgr-title-value title="Namn:">
                                  <vgr-input formControlName="name" [showValidation]="!clinicForm.get('name').valid && clinicForm.get('name').touched "></vgr-input>
                              </vgr-title-value>
                          </vgr-title-value-layout>

                      </vgr-card-column>
                      <vgr-card-column></vgr-card-column>
                    </vgr-card>

                    <vgr-card class="card-controls">
                        <vgr-card-column>

                            <div class="containers">

                                <vgr-button buttonStyle="discreet" (click)="openDeleteModal(clinic)">
                                    <span class="material-icons icon-tomato">delete</span>
                                </vgr-button>
                              </div>  
                        </vgr-card-column>
                        <vgr-card-column>
                            <div class="containers">
                                <vgr-button default="true" (click)="saveClinic()" [disabled]="!(clinicForm.valid)">Spara</vgr-button>
                                <vgr-button buttonStyle="secondary" (click)="collapse(addListItem)" >Avbryt</vgr-button>
                            </div>
                        </vgr-card-column>
                    </vgr-card>

                </form>

              </vgr-list-item-content>
            </vgr-list-item>
    
            <vgr-list-item (expandedChanged)="setCurrentClinic($event, null)" #addListItem>
              <vgr-list-item-header>
                <vgr-list-column width="5">
                  <div class="add-row vgr-icon-plus">LÃ¤gg till klinik</div>
                </vgr-list-column>
              </vgr-list-item-header>
    
              <vgr-list-item-content [indentContent]="true">
                <form [formGroup]="clinicForm" (ngSubmit)="saveClinic()">

                    <!-- For some reason this is needed here, but not in the above form, in order for enter button to work. -->
                    <button type="submit" style="display:none">send</button>

                    <vgr-card>
                        <vgr-card-column>
                          <vgr-title-value-layout>
                              <vgr-title-value title="ID:">
                                  <vgr-input formControlName="id" [showValidation]="!clinicForm.get('id').valid && clinicForm.get('id').touched " #addClinicId></vgr-input>
                              </vgr-title-value>
                              <vgr-title-value title="Namn:">
                                  <vgr-input formControlName="name" [showValidation]="!clinicForm.get('name').valid && clinicForm.get('name').touched "></vgr-input>
                              </vgr-title-value>
                          </vgr-title-value-layout>
                      </vgr-card-column>
                      <vgr-card-column></vgr-card-column>
                    </vgr-card>

                    <vgr-card class="card-controls">
                        <vgr-card-column>
                        </vgr-card-column>
                        <vgr-card-column>
                            <div class="containers">
                                <vgr-button (click)="saveClinic()" [disabled]="!clinicForm.valid">Spara</vgr-button>
                                <vgr-button buttonStyle="secondary" (click)="collapse(addListItem)" >Avbryt</vgr-button>
                            </div>
                        </vgr-card-column>
                    </vgr-card>

                </form>
              </vgr-list-item-content>
    
            </vgr-list-item>
          </vgr-list>
        </vgr-page-block>
  </app-left-column>
  <app-right-column>
  </app-right-column>
</app-row>

<app-delete-modal [itemLabel]="clinicForDeletion?.name" (confirmDelete)="confirmDelete()"></app-delete-modal>
